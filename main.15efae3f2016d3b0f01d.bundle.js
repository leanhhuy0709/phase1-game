(()=>{"use strict";const t=["assets/background/1.png","assets/background/2.png","assets/background/3.png"],s=1e3;var e,i,a=5;!function(t){t[t.GAME_MENU=1]="GAME_MENU",t[t.GAME_PLAY=2]="GAME_PLAY",t[t.GAME_OVER=3]="GAME_OVER"}(e||(e={}));class h{static add(t,s=0,e=0,i=-1,a=-1){h.imagesString.push(t),h.imagesStat.push([s,e,i,a])}static draw(){for(var t=h.imagesString.length,s=0,e=0;e<t;e++)h.images[e]=new Image,h.images[e].src=h.imagesString[e],h.images[e].onload=function(){++s==t&&h.drawImage()}}static drawImage(){for(var t,s,e=0;e<h.imagesString.length;e++)-1==h.imagesStat[e][2]?null===(t=h.ctx)||void 0===t||t.drawImage(h.images[e],h.imagesStat[e][0],h.imagesStat[e][1]):null===(s=h.ctx)||void 0===s||s.drawImage(h.images[e],h.imagesStat[e][0],h.imagesStat[e][1],h.imagesStat[e][2],h.imagesStat[e][3]);h.imagesString.length=0,h.imagesStat.length=0}}h.canvas=document.getElementById("game"),h.ctx=h.canvas.getContext("2d"),h.imagesString=[],h.imagesStat=[],h.images=new Array;class r{constructor(){this.start()}start(){console.log("TRexJump created"),h.canvas.width=700,h.canvas.height=400,h.canvas.setAttribute("style","margin: auto"),this.tRex=new c,this.sceneNum=0,this.obtacles=new l,this.score=new d,a=5,this.state=e.GAME_MENU,this.background=new g,h.canvas.addEventListener("keydown",(t=>{switch(t.preventDefault(),t.key,t.code){case"ArrowUp":case"Space":this.tRex.state!=i.FALL&&(this.tRex.state=i.JUMP);break;case"ArrowDown":this.tRex.state!=i.JUMP&&this.tRex.state!=i.FALL||(this.tRex.jumpSize*=3,this.tRex.state=i.FALL),this.tRex.state==i.MOVE&&(this.tRex.state=i.DUCK)}}),!1),h.canvas.addEventListener("keyup",(t=>{switch(t.preventDefault(),t.key,t.code){case"ArrowUp":case"Space":this.tRex.state==i.JUMP&&(this.tRex.state=i.FALL);break;case"ArrowDown":this.tRex.state==i.DUCK&&(this.tRex.state=i.MOVE)}}),!1),h.canvas.addEventListener("mousedown",(t=>{let s=h.canvas.getBoundingClientRect(),a=t.clientX-s.left,r=t.clientY-s.top;this.state==e.GAME_PLAY&&this.tRex.state!=i.FALL&&(this.tRex.state=i.JUMP),this.state!=e.GAME_OVER&&this.state!=e.GAME_MENU||(a-350)*(a-350)+(r-260)*(r-260)<1600&&(this.tRex.start(),this.obtacles.start(),this.score.start(),this.sceneNum=0,this.changeState(e.GAME_PLAY))}),!1)}update(){let t=this.background.getCurrent(),r=this.background.getNext();switch(h.add(t,this.sceneNum,0),this.sceneNum<=h.canvas.width-s&&h.add(r,this.sceneNum+s,0),this.state){case e.GAME_PLAY:this.sceneNum-=a,this.sceneNum<=-1e3&&(this.sceneNum+=s,this.background.stt=(this.background.stt+1)%this.background.list.length),this.tRex.update(),this.score.update(),this.obtacles.update(),this.obtacles.checkCollision(this.tRex)&&this.changeState(e.GAME_OVER);break;case e.GAME_OVER:h.ctx&&(h.ctx.font="bold 50px Cambria",h.ctx.textAlign="center",h.ctx.fillText("GAME OVER",350,150),h.ctx.font="30px Cambria",h.ctx.fillText(`Highscore: ${Math.floor(this.score.maxScore)}`,350,200),this.tRex.state=i.DEAD,this.tRex.update(),this.obtacles.update(!0),this.score.update(!0),h.ctx.beginPath(),h.ctx.arc(350,260,40,0,2*Math.PI),h.ctx.stroke(),h.ctx.beginPath(),h.ctx.moveTo(340,240),h.ctx.lineTo(340,280),h.ctx.lineTo(370,260),h.ctx.fill(),this.tRex.update());break;case e.GAME_MENU:h.ctx&&(h.ctx.font="bold 50px Cambria",h.ctx.textAlign="center",h.ctx.fillText("T-Rex Jump",350,150),h.ctx.font="30px Cambria",h.ctx.fillText(`Highscore: ${this.score.maxScore}`,350,200),this.tRex.state=i.IDLE,this.tRex.update(),this.obtacles.update(!0),h.ctx.beginPath(),h.ctx.arc(350,260,40,0,2*Math.PI),h.ctx.stroke(),h.ctx.beginPath(),h.ctx.moveTo(340,240),h.ctx.lineTo(340,280),h.ctx.lineTo(370,260),h.ctx.fill(),this.tRex.update())}h.draw()}changeState(t){this.state=t}}!function(t){t[t.MOVE=1]="MOVE",t[t.JUMP=2]="JUMP",t[t.FALL=3]="FALL",t[t.DEAD=4]="DEAD",t[t.IDLE=5]="IDLE",t[t.DUCK=6]="DUCK"}(i||(i={}));class n{constructor(t){this.sprites=t,this.stt=0,this.delay=0}getSprite(){return this.stt>=this.sprites.length&&console.log("Error Sprites"),this.sprites[this.stt]}addStt(){return this.delay++,this.delay>10&&(this.stt++,this.delay=0),this.stt%=this.sprites.length,this.stt}}class c{constructor(){this.start()}start(){console.log("TRex created"),this.moveSprite=new n(["assets/dinosaur-sprites/Run (1).png","assets/dinosaur-sprites/Run (2).png","assets/dinosaur-sprites/Run (3).png","assets/dinosaur-sprites/Run (4).png","assets/dinosaur-sprites/Run (5).png","assets/dinosaur-sprites/Run (6).png","assets/dinosaur-sprites/Run (7).png","assets/dinosaur-sprites/Run (8).png"]),this.jumpSprite=new n(["assets/dinosaur-sprites/Jump (1).png","assets/dinosaur-sprites/Jump (2).png","assets/dinosaur-sprites/Jump (3).png","assets/dinosaur-sprites/Jump (4).png","assets/dinosaur-sprites/Jump (5).png","assets/dinosaur-sprites/Jump (6).png","assets/dinosaur-sprites/Jump (7).png","assets/dinosaur-sprites/Jump (8).png"]),this.fallSprite=new n(["assets/dinosaur-sprites/Jump (9).png","assets/dinosaur-sprites/Jump (10).png","assets/dinosaur-sprites/Jump (11).png","assets/dinosaur-sprites/Jump (12).png"]),this.deadSprite=new n(["assets/dinosaur-sprites/Dead (6).png"]),this.idleSprite=new n(["assets/dinosaur-sprites/Idle (1).png"]),this.duckSprite=new n(["assets/dinosaur-sprites/Duck (1).png"]),this.xDefault=10,this.yDefault=250,this.jumpSizeDefault=5,this.widthDefault=100,this.heightDefault=100,this.width=this.widthDefault,this.height=this.heightDefault,this.x=this.xDefault,this.y=this.yDefault,this.jumpSize=this.jumpSizeDefault,this.state=i.MOVE}update(){const t=new Image;let s=this.width,e=this.height,a=this.x,r=this.y;switch(this.state){case i.MOVE:this.width=this.widthDefault,this.height=this.heightDefault,this.x=this.xDefault,this.y=this.yDefault,this.jumpSprite.stt=this.fallSprite.stt=0,this.moveSprite.addStt(),t.src=this.moveSprite.getSprite();break;case i.JUMP:this.jumpSize=this.jumpSizeDefault,this.moveSprite.stt=this.fallSprite.stt=0,this.y-=this.jumpSize,this.jumpSprite.stt+1<this.jumpSprite.sprites.length&&this.jumpSprite.addStt(),t.src=this.jumpSprite.getSprite(),this.y<=this.yDefault-30*this.jumpSize&&(this.state=i.FALL);break;case i.FALL:this.jumpSprite.stt=this.moveSprite.stt=0,this.y+=this.jumpSize/2,this.fallSprite.stt+2<this.fallSprite.sprites.length&&this.fallSprite.addStt(),t.src=this.fallSprite.getSprite(),this.y+10*this.jumpSize>=this.yDefault&&(this.fallSprite.stt=this.fallSprite.sprites.length-2),this.y+20*this.jumpSize>=this.yDefault&&(this.fallSprite.stt=this.fallSprite.sprites.length-1),this.y>=this.yDefault&&(this.y=this.yDefault,this.state=i.MOVE,this.fallSprite.stt=0);break;case i.DEAD:this.y=this.yDefault,t.src=this.deadSprite.getSprite(),s=4*this.widthDefault/3-10,e=2*this.heightDefault/3-10,r=this.heightDefault-e+10+this.yDefault,this.width=s,this.height=e,this.y=r;break;case i.IDLE:this.y=this.yDefault,t.src=this.idleSprite.getSprite();break;case i.DUCK:this.y=this.yDefault,t.src=this.duckSprite.getSprite(),s=4*this.widthDefault/3-10,e=2*this.heightDefault/3-10,r=this.heightDefault-e+10+this.yDefault,this.width=s,this.height=e,this.y=r}h.add(t.src,a,r,s,e)}}class l{constructor(){this.start()}start(){this.obtacles=[new p(1e3),new u(1500)]}update(t=!1){let s=0;for(let e=0;e<this.obtacles.length;e++)this.obtacles[e].x<=1210&&this.obtacles[e].render(),t||(this.obtacles[e].x-=a+this.obtacles[e].moveSpeed),this.obtacles[e].x<-this.obtacles[e].width&&s++;if(!t){this.obtacles=this.obtacles.slice(s,this.obtacles.length);for(let t=0;t<s;t++)switch(Math.floor(4*Math.random())){case 0:case 1:case 2:this.obtacles.push(new u(this.obtacles[this.obtacles.length-1].x+Math.floor(1e3*Math.random())+500));break;default:this.obtacles.push(new p(this.obtacles[this.obtacles.length-1].x+Math.floor(1e3*Math.random())+500))}}}checkCollision(t){let s,e,i,a,h,r,n,c;s=t.x,e=t.y,i=t.width-20,a=t.height-20;for(let t=0;t<this.obtacles.length;t++)if(h=this.obtacles[t].x,r=this.obtacles[t].y,n=this.obtacles[t].width-10,c=this.obtacles[t].height-10,s+i>=h&&h+n>=s&&e+i>=r&&r+n>=e)return!0;return!1}}class o{constructor(){}render(){const t=new Image;t.src=this.sprite.getSprite();let s=this.width,e=this.height,i=this.y,a=this.x;h.add(t.src,a,i,s,e)}}class u extends o{constructor(t){super(),this.sprite=new n(["assets/Cactus/Cactus.png"]),this.x=t,this.width=60,this.height=80,this.y=280,this.moveSpeed=0}}class p extends o{constructor(t){super(),this.sprite=new n(["assets/fly-dinosaur/1.png","assets/fly-dinosaur/2.png"]),this.sprite.stt=Math.floor(2*Math.random()),this.x=t,this.width=80,this.height=50,this.y=70*Math.floor(2*Math.random())+150,this.moveSpeed=1}}class d{constructor(){this.maxScore=0,this.start()}start(){this.score=0,this.level=1e3}update(t=!1){t?this.maxScore=this.maxScore>this.score?this.maxScore:this.score:(this.score+=a/5,this.score>this.level&&(a+=1,this.level+=1e3)),h.ctx&&(h.ctx.font="30px Cambria",h.ctx.textAlign="start",h.ctx.fillText(Math.floor(this.score).toString(),20,30))}}class g{constructor(){this.list=[],this.stt=0;for(let s=0;s<6;s++){let s=t[Math.floor(Math.random()*t.length)];for(let t=0;t<5;t++)this.list.push(s)}}getCurrent(){return this.list[this.stt]}getNext(){return this.list[(this.stt+1)%this.list.length]}}(new class{constructor(){}update(){this.tRexJump.update(),requestAnimationFrame((()=>this.update()))}start(){this.tRexJump=new r,requestAnimationFrame((()=>this.update()))}}).start()})();