(()=>{"use strict";var t="phase1-game";"localhost"===window.location.hostname&&(t="");const s=t+"assets/dinosaur-sprites/Jump (1).png",e=t+"assets/dinosaur-sprites/Jump (2).png",i=t+"assets/dinosaur-sprites/Jump (3).png",a=t+"assets/dinosaur-sprites/Jump (4).png",h=t+"assets/dinosaur-sprites/Jump (5).png",r=t+"assets/dinosaur-sprites/Jump (6).png",n=t+"assets/dinosaur-sprites/Jump (7).png",c=t+"assets/dinosaur-sprites/Jump (8).png",l=t+"assets/dinosaur-sprites/Jump (9).png",o=t+"assets/dinosaur-sprites/Jump (10).png",u=t+"assets/dinosaur-sprites/Jump (11).png",p=t+"assets/dinosaur-sprites/Jump (12).png",d=t+"assets/dinosaur-sprites/Run (1).png",g=t+"assets/dinosaur-sprites/Run (2).png",m=t+"assets/dinosaur-sprites/Run (3).png",x=t+"assets/dinosaur-sprites/Run (4).png",f=t+"assets/dinosaur-sprites/Run (5).png",S=t+"assets/dinosaur-sprites/Run (6).png",w=t+"assets/dinosaur-sprites/Run (7).png",b=t+"assets/dinosaur-sprites/Run (8).png",D=t+"assets/dinosaur-sprites/Dead (6).png",M=t+"assets/dinosaur-sprites/Idle (1).png",E=t+"assets/dinosaur-sprites/Duck (1).png",y=[t+"assets/background/1.png",t+"assets/background/2.png",t+"assets/background/3.png"],A=t+"assets/Cactus/Cactus.png",R=t+"assets/fly-dinosaur/1.png",v=t+"assets/fly-dinosaur/2.png",k=1e3;var L,J,U=5;!function(t){t[t.GAME_MENU=1]="GAME_MENU",t[t.GAME_PLAY=2]="GAME_PLAY",t[t.GAME_OVER=3]="GAME_OVER"}(L||(L={}));class j{static add(t,s=0,e=0,i=-1,a=-1){j.imagesString.push(t),j.imagesStat.push([s,e,i,a])}static draw(){for(var t=j.imagesString.length,s=0,e=0;e<t;e++)j.images[e]=new Image,j.images[e].src=j.imagesString[e],j.images[e].onload=function(){++s==t&&j.drawImage()}}static drawImage(){for(var t,s,e=0;e<j.imagesString.length;e++)-1==j.imagesStat[e][2]?null===(t=j.ctx)||void 0===t||t.drawImage(j.images[e],j.imagesStat[e][0],j.imagesStat[e][1]):null===(s=j.ctx)||void 0===s||s.drawImage(j.images[e],j.imagesStat[e][0],j.imagesStat[e][1],j.imagesStat[e][2],j.imagesStat[e][3]);j.imagesString.length=0,j.imagesStat.length=0}}j.canvas=document.getElementById("game"),j.ctx=j.canvas.getContext("2d"),j.imagesString=[],j.imagesStat=[],j.images=new Array;class C{constructor(){this.start()}start(){console.log("TRexJump created"),j.canvas.width=700,j.canvas.height=400,j.canvas.setAttribute("style","margin: auto"),this.tRex=new G,this.sceneNum=0,this.obtacles=new I,this.score=new O,U=5,this.state=L.GAME_MENU,this.background=new V,j.canvas.addEventListener("keydown",(t=>{switch(t.preventDefault(),t.key,t.code){case"ArrowUp":case"Space":this.tRex.state!=J.FALL&&(this.tRex.state=J.JUMP);break;case"ArrowDown":this.tRex.state!=J.JUMP&&this.tRex.state!=J.FALL||(this.tRex.jumpSize*=3,this.tRex.state=J.FALL),this.tRex.state==J.MOVE&&(this.tRex.state=J.DUCK)}}),!1),j.canvas.addEventListener("keyup",(t=>{switch(t.preventDefault(),t.key,t.code){case"ArrowUp":case"Space":this.tRex.state==J.JUMP&&(this.tRex.state=J.FALL);break;case"ArrowDown":this.tRex.state==J.DUCK&&(this.tRex.state=J.MOVE)}}),!1),j.canvas.addEventListener("mousedown",(t=>{let s=j.canvas.getBoundingClientRect(),e=t.clientX-s.left,i=t.clientY-s.top;this.state==L.GAME_PLAY&&this.tRex.state!=J.FALL&&(this.tRex.state=J.JUMP),this.state!=L.GAME_OVER&&this.state!=L.GAME_MENU||(e-350)*(e-350)+(i-260)*(i-260)<1600&&(this.tRex.start(),this.obtacles.start(),this.score.start(),this.sceneNum=0,this.changeState(L.GAME_PLAY))}),!1)}update(){let t=this.background.getCurrent(),s=this.background.getNext();switch(j.add(t,this.sceneNum,0),this.sceneNum<=j.canvas.width-k&&j.add(s,this.sceneNum+k,0),this.state){case L.GAME_PLAY:this.sceneNum-=U,this.sceneNum<=-1e3&&(this.sceneNum+=k,this.background.stt=(this.background.stt+1)%this.background.list.length),this.tRex.update(),this.score.update(),this.obtacles.update(),this.obtacles.checkCollision(this.tRex)&&this.changeState(L.GAME_OVER);break;case L.GAME_OVER:j.ctx&&(j.ctx.font="bold 50px Cambria",j.ctx.textAlign="center",j.ctx.fillText("GAME OVER",350,150),j.ctx.font="30px Cambria",j.ctx.fillText(`Highscore: ${Math.floor(this.score.maxScore)}`,350,200),this.tRex.state=J.DEAD,this.tRex.update(),this.obtacles.update(!0),this.score.update(!0),j.ctx.beginPath(),j.ctx.arc(350,260,40,0,2*Math.PI),j.ctx.stroke(),j.ctx.beginPath(),j.ctx.moveTo(340,240),j.ctx.lineTo(340,280),j.ctx.lineTo(370,260),j.ctx.fill(),this.tRex.update());break;case L.GAME_MENU:j.ctx&&(j.ctx.font="bold 50px Cambria",j.ctx.textAlign="center",j.ctx.fillText("T-Rex Jump",350,150),j.ctx.font="30px Cambria",j.ctx.fillText(`Highscore: ${this.score.maxScore}`,350,200),this.tRex.state=J.IDLE,this.tRex.update(),this.obtacles.update(!0),j.ctx.beginPath(),j.ctx.arc(350,260,40,0,2*Math.PI),j.ctx.stroke(),j.ctx.beginPath(),j.ctx.moveTo(340,240),j.ctx.lineTo(340,280),j.ctx.lineTo(370,260),j.ctx.fill(),this.tRex.update())}j.draw()}changeState(t){this.state=t}}!function(t){t[t.MOVE=1]="MOVE",t[t.JUMP=2]="JUMP",t[t.FALL=3]="FALL",t[t.DEAD=4]="DEAD",t[t.IDLE=5]="IDLE",t[t.DUCK=6]="DUCK"}(J||(J={}));class P{constructor(t){this.sprites=t,this.stt=0,this.delay=0}getSprite(){return this.stt>=this.sprites.length&&console.log("Error Sprites"),this.sprites[this.stt]}addStt(){return this.delay++,this.delay>10&&(this.stt++,this.delay=0),this.stt%=this.sprites.length,this.stt}}class G{constructor(){this.start()}start(){console.log("TRex created"),this.moveSprite=new P([d,g,m,x,f,S,w,b]),this.jumpSprite=new P([s,e,i,a,h,r,n,c]),this.fallSprite=new P([l,o,u,p]),this.deadSprite=new P([D]),this.idleSprite=new P([M]),this.duckSprite=new P([E]),this.xDefault=10,this.yDefault=250,this.jumpSizeDefault=5,this.widthDefault=100,this.heightDefault=100,this.width=this.widthDefault,this.height=this.heightDefault,this.x=this.xDefault,this.y=this.yDefault,this.jumpSize=this.jumpSizeDefault,this.state=J.MOVE}update(){const t=new Image;let s=this.width,e=this.height,i=this.x,a=this.y;switch(this.state){case J.MOVE:this.width=this.widthDefault,this.height=this.heightDefault,this.x=this.xDefault,this.y=this.yDefault,this.jumpSprite.stt=this.fallSprite.stt=0,this.moveSprite.addStt(),t.src=this.moveSprite.getSprite();break;case J.JUMP:this.width=this.widthDefault,this.height=this.heightDefault,this.jumpSize=this.jumpSizeDefault,this.moveSprite.stt=this.fallSprite.stt=0,this.y-=this.jumpSize,this.jumpSprite.stt+1<this.jumpSprite.sprites.length&&this.jumpSprite.addStt(),t.src=this.jumpSprite.getSprite(),this.y<=this.yDefault-30*this.jumpSize&&(this.state=J.FALL);break;case J.FALL:this.width=this.widthDefault,this.height=this.heightDefault,this.jumpSprite.stt=this.moveSprite.stt=0,this.y+=this.jumpSize/2,this.fallSprite.stt+2<this.fallSprite.sprites.length&&this.fallSprite.addStt(),t.src=this.fallSprite.getSprite(),this.y+10*this.jumpSize>=this.yDefault&&(this.fallSprite.stt=this.fallSprite.sprites.length-2),this.y+20*this.jumpSize>=this.yDefault&&(this.fallSprite.stt=this.fallSprite.sprites.length-1),this.y>=this.yDefault&&(this.y=this.yDefault,this.state=J.MOVE,this.fallSprite.stt=0);break;case J.DEAD:this.y=this.yDefault,t.src=this.deadSprite.getSprite(),s=4*this.widthDefault/3-10,e=2*this.heightDefault/3-10,a=this.heightDefault-e+10+this.yDefault,this.width=s,this.height=e,this.y=a;break;case J.IDLE:this.y=this.yDefault,t.src=this.idleSprite.getSprite();break;case J.DUCK:this.y=this.yDefault,t.src=this.duckSprite.getSprite(),s=4*this.widthDefault/3-10,e=2*this.heightDefault/3-10,a=this.heightDefault-e+10+this.yDefault,this.width=s,this.height=e,this.y=a}j.add(t.src,i,a,s,e)}}class I{constructor(){this.start()}start(){this.obtacles=[new T(1e3),new _(1500)]}update(t=!1){let s=0;for(let e=0;e<this.obtacles.length;e++)this.obtacles[e].x<=1210&&this.obtacles[e].render(),t||(this.obtacles[e].x-=U+this.obtacles[e].moveSpeed),this.obtacles[e].x<-this.obtacles[e].width&&s++;if(!t){this.obtacles=this.obtacles.slice(s,this.obtacles.length);for(let t=0;t<s;t++)switch(Math.floor(4*Math.random())){case 0:case 1:case 2:this.obtacles.push(new _(this.obtacles[this.obtacles.length-1].x+Math.floor(1e3*Math.random())+500));break;default:this.obtacles.push(new T(this.obtacles[this.obtacles.length-1].x+Math.floor(1e3*Math.random())+500))}}}checkCollision(t){let s,e,i,a,h,r,n,c;s=t.x,e=t.y,i=t.width-20,a=t.height-20;for(let t=0;t<this.obtacles.length;t++)if(h=this.obtacles[t].x,r=this.obtacles[t].y,n=this.obtacles[t].width-10,c=this.obtacles[t].height-10,s+i>=h&&h+n>=s&&e+i>=r&&r+n>=e)return!0;return!1}}class N{constructor(){}render(){const t=new Image;t.src=this.sprite.getSprite();let s=this.width,e=this.height,i=this.y,a=this.x;j.add(t.src,a,i,s,e)}}class _ extends N{constructor(t){super(),this.sprite=new P([A]),this.x=t,this.width=60,this.height=80,this.y=280,this.moveSpeed=0}}class T extends N{constructor(t){super(),this.sprite=new P([R,v]),this.sprite.stt=Math.floor(2*Math.random()),this.x=t,this.width=80,this.height=50,this.y=70*Math.floor(2*Math.random())+150,this.moveSpeed=1}}class O{constructor(){this.maxScore=0,this.start()}start(){this.score=0,this.level=1e3}update(t=!1){t?this.maxScore=this.maxScore>this.score?this.maxScore:this.score:(this.score+=U/5,this.score>this.level&&(U+=1,this.level+=1e3)),j.ctx&&(j.ctx.font="30px Cambria",j.ctx.textAlign="start",j.ctx.fillText(Math.floor(this.score).toString(),20,30))}}class V{constructor(){this.list=[],this.stt=0;for(let t=0;t<6;t++){let t=y[Math.floor(Math.random()*y.length)];for(let s=0;s<5;s++)this.list.push(t)}}getCurrent(){return this.list[this.stt]}getNext(){return this.list[(this.stt+1)%this.list.length]}}(new class{constructor(){}update(){this.tRexJump.update(),requestAnimationFrame((()=>this.update()))}start(){this.tRexJump=new C,requestAnimationFrame((()=>this.update()))}}).start()})();